<!-- appl/templates/edit_operator.html -->
{% extends "base.html" %}  <!-- Includi il template base -->

{% block content %}
<br>
    <div class="container">
        <h1 class="mt-5">Modifica Operatore</h1>
        <form method="POST" action="{{ url_for('settings.edit_operator', operator_id=operator.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="form-group">
                <label for="user_nome">Nome:</label>
                <input type="text" class="form-control" id="user_nome" name="user_nome" value="{{ operator.user_nome }}" required>
            </div>

            <div class="form-group">
                <label for="user_cognome">Cognome:</label>
                <input type="text" class="form-control" id="user_cognome" name="user_cognome" value="{{ operator.user_cognome }}">
            </div>

            <div class="form-group" id="cellulareField">
            <label for="user_cellulare">Cellulare:</label>
            <input type="text"
                    class="form-control"
                    id="user_cellulare"
                    name="user_cellulare"
                    value="{{ operator.user_cellulare }}"
                    placeholder="3331234567"
                    inputmode="numeric">
            </div>

            <div class="form-group">
                <label for="user_tipo">Tipo:</label>
                <select class="form-control" id="user_tipo" name="user_tipo" required>
                    <option value="estetista" {% if operator.user_tipo == 'estetista' %}selected{% endif %}>Estetista</option>
                    <option value="macchinario" {% if operator.user_tipo == 'macchinario' %}selected{% endif %}>Solarium</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary">Salva</button>
            <a href="{{ url_for('settings.operators') }}" class="btn btn-secondary">Annulla</a>
        </form>
    </div>

    <!-- Aggiungi i file JS di Bootstrap, se necessario -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
function toggleTipoFieldsEdit() {
  const tipo = document.getElementById('user_tipo').value;
  const cognomeField = document.getElementById('user_cognome').closest('.form-group');
  const cellulareField = document.getElementById('cellulareField');
  const cognomeInput = document.getElementById('user_cognome');
  const cellulareInput = document.getElementById('user_cellulare');

  if (tipo === 'macchinario') {
    if (cognomeField) cognomeField.style.display = 'none';
    cognomeInput.value = '';
    cognomeInput.removeAttribute('required');

    cellulareField.style.display = 'none';
    cellulareInput.value = '';
    cellulareInput.removeAttribute('required');
  } else {
    if (cognomeField) cognomeField.style.display = 'block';
    cognomeInput.setAttribute('required', 'required');

    cellulareField.style.display = 'block';
    cellulareInput.setAttribute('required', 'required');
  }
}

document.addEventListener('DOMContentLoaded', function () {
  toggleTipoFieldsEdit();
  document.getElementById('user_tipo').addEventListener('change', toggleTipoFieldsEdit);
});
</script>
    {% endblock %}